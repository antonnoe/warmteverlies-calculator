<!DOCTYPE html>
<html lang="nl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Warmteverlies Calculator Frankrijk - InfoFrankrijk.com</title>
    
    <script crossorigin src="https://unpkg.com/react@17/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@17/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
    
    <script src="https://cdn.tailwindcss.com"></script>
    
    <style>
        body { 
            margin: 0; 
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: #f8f9fa;
        }
        
        .text-brand-red {
            color: #800000 !important;
        }
        
        h1, h2 {
            color: #800000 !important;
        }
        
        .sticky-costs {
            position: fixed;
            left: 20px;
            top: 50%;
            transform: translateY(-50%);
            z-index: 1000;
            width: 280px;
            max-height: 80vh;
            overflow-y: auto;
        }
        
        @media (max-width: 1280px) {
            .sticky-costs {
                position: static;
                transform: none;
                width: 100%;
                max-height: none;
                overflow-y: visible;
            }
        }
        
        @media (min-width: 1281px) {
            .main-content {
                margin-left: 320px;
            }
        }
        
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            flex-direction: column;
        }
        
        .spinner {
            border: 4px solid #f3f3f3;
            border-top: 4px solid #800000;
            border-radius: 50%;
            width: 50px;
            height: 50px;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .tooltip {
            position: relative;
            cursor: help;
            color: #800000;
        }
        
        .tooltip .tooltiptext {
            visibility: hidden;
            width: 300px;
            background-color: #333;
            color: #fff;
            text-align: left;
            border-radius: 6px;
            padding: 15px;
            position: absolute;
            z-index: 1000;
            bottom: 125%;
            left: 50%;
            margin-left: -150px;
            opacity: 0;
            transition: opacity 0.3s;
            font-size: 14px;
            line-height: 1.4;
        }
        
        .tooltip:hover .tooltiptext {
            visibility: visible;
            opacity: 1;
        }
        
        .input-error {
            border-color: #ef4444 !important;
            background-color: #fef2f2 !important;
        }
        
        .error-text {
            color: #ef4444;
            font-size: 0.75rem;
            margin-top: 0.25rem;
        }
    </style>
</head>
<body>
    <div id="loading" class="loading">
        <div class="spinner"></div>
        <p style="margin-top: 20px; color: #666;">Calculator wordt geladen...</p>
    </div>
    
    <div id="root"></div>
    
    <script>
        const ENERGY_API = {
            getFallbackPrices() {
                return {
                    gas: 0.0847,
                    electricity: 0.2516,
                    fioul: 1.15,
                    pellets: 0.35,
                    source: 'CRE - Commission de r√©gulation de l\'√©nergie',
                    updateFrequency: 'Wekelijks bijgewerkt',
                    region: 'France m√©tropolitaine'
                };
            }
        };
        
        function debounce(func, wait) {
            let timeout;
            return function executedFunction(...args) {
                const later = () => {
                    clearTimeout(timeout);
                    func(...args);
                };
                clearTimeout(timeout);
                timeout = setTimeout(later, wait);
            };
        }
        
        window.ENERGY_API = ENERGY_API;
        window.debounce = debounce;
    </script>

    <script type="text/babel">
        const { useState, useEffect, useCallback } = React;
        
        const Calculator = () => <span>üßÆ</span>;
        const Home = () => <span>üè†</span>;
        const Thermometer = () => <span>üå°Ô∏è</span>;
        const Euro = () => <span>üí∞</span>;
        const TrendingDown = () => <span>üìâ</span>;
        const MapPin = () => <span>üìç</span>;
        const HelpCircle = () => <span style={{color: '#800000'}}>‚ùì</span>;
        const Sun = () => <span>‚òÄÔ∏è</span>;

        const WarmteverliesCalculator = () => {
            const [inputs, setInputs] = useState({
                muurOppervlakte: 100,
                raamOppervlakte: 20,
                dakOppervlakte: 80,
                vloerOppervlakte: 80,
                muurUwaarde: 1.8,
                raamUwaarde: 5.0,
                dakUwaarde: 2.5,
                vloerUwaarde: 0.8,
                binnenTemp: 20,
                klimaatzone: 'H2a',
                woningGebruik: 'volledig',
                verwarmdeRuimtes: 'heel_huis',
                ventilatieGedrag: 'normaal',
                bijverwarmingType: 'geen',
                bijverwarmingIntensiteit: 'incidenteel',
                hoofdverwarmingType: 'gas',
                zonnepanelenAantal: 0,
                zonnepanelenOrientatie: 'zuid',
                zonnepanelenHelling: 'optimaal'
            });

            const [results, setResults] = useState({});
            const [energyPrices, setEnergyPrices] = useState(ENERGY_API.getFallbackPrices());
            const [errors, setErrors] = useState({});
            const [isCalculating, setIsCalculating] = useState(false);

            const klimaatzones = {
                'H1a': { naam: 'H1a - Noordoost (Reims, Metz)', factor: 1.2, gemTemp: -5, verwarmingsDagen: 200, zonOpbrengst: 1050 },
                'H1b': { naam: 'H1b - Noord/Centrum (Parijs, Lille)', factor: 1.1, gemTemp: -3, verwarmingsDagen: 185, zonOpbrengst: 1100 },
                'H1c': { naam: 'H1c - West (Brest, Caen)', factor: 1.0, gemTemp: 2, verwarmingsDagen: 175, zonOpbrengst: 1000 },
                'H2a': { naam: 'H2a - Midden-west (Poitiers, Tours)', factor: 0.9, gemTemp: 0, verwarmingsDagen: 170, zonOpbrengst: 1250 },
                'H2b': { naam: 'H2b - Midden-oost (Lyon, Dijon)', factor: 0.95, gemTemp: -2, verwarmingsDagen: 180, zonOpbrengst: 1200 },
                'H2c': { naam: 'H2c - Zuidwest (Bordeaux, Toulouse)', factor: 0.8, gemTemp: 3, verwarmingsDagen: 155, zonOpbrengst: 1350 },
                'H2d': { naam: 'H2d - Zuidoost (Avignon, Montpellier)', factor: 0.7, gemTemp: 4, verwarmingsDagen: 145, zonOpbrengst: 1450 },
                'H3': { naam: 'H3 - Mediterraan (Nice, Marseille)', factor: 0.6, gemTemp: 6, verwarmingsDagen: 120, zonOpbrengst: 1500 }
            };

            const uWaardePresets = {
                muur: {
                    'Onge√Øsoleerd (voor 1975)': 2.0,
                    'Licht ge√Øsoleerd (5cm)': 0.8,
                    'Goed ge√Øsoleerd (10cm)': 0.4,
                    'Zeer goed ge√Øsoleerd (15cm+)': 0.25
                },
                raam: {
                    'Enkel glas': 5.5,
                    'Dubbel glas standaard': 3.0,
                    'Dubbel glas HR': 1.8,
                    'Triple glas HR++': 1.0
                },
                dak: {
                    'Onge√Øsoleerd': 3.0,
                    'Licht ge√Øsoleerd (10cm)': 0.5,
                    'Goed ge√Øsoleerd (20cm)': 0.25,
                    'Zeer goed ge√Øsoleerd (30cm+)': 0.15
                },
                vloer: {
                    'Onge√Øsoleerd (oude boerderij)': 2.2,
                    'Matig (houten vloer + dun materiaal)': 1.2,
                    'Redelijk (isolatie onder vloer)': 0.8,
                    'Goed (moderne dubbele isolatie)': 0.3
                }
            };

            const woningGebruikOpties = {
                'volledig': { naam: 'Volledig jaar', factor: 1.0 },
                'secondaire_zomer': { naam: 'Zomer + tussenseizoen', factor: 0.3 },
                'secondaire_winter': { naam: 'Winter weekends', factor: 0.4 },
                'weekend': { naam: 'Alleen weekends', factor: 0.25 }
            };

            const zonOrientatieFactoren = {
                'zuid': 1.0,
                'zuidwest': 0.95,
                'zuidoost': 0.95,
                'oost': 0.85,
                'west': 0.85
            };

            const zonHellingFactoren = {
                'vlak': 0.85,
                'optimaal': 1.0,
                'steil': 0.9
            };

            useEffect(() => {
                const timer = setTimeout(() => {
                    const loadingElement = document.getElementById('loading');
                    if (loadingElement) {
                        loadingElement.style.display = 'none';
                    }
                }, 1000);
                return () => clearTimeout(timer);
            }, []);

            const getBuitenTemperatuur = () => {
                return klimaatzones[inputs.klimaatzone]?.gemTemp || 0;
            };

            const calculateHeatLoss = useCallback(() => {
                try {
                    setIsCalculating(true);

                    // --- START VAN DE FIX ---
                    // Zet alle input-waarden veilig om naar getallen voordat we gaan rekenen.
                    // Dit voorkomt 'NaN' fouten en zorgt dat de calculator niet stopt bij lege velden.
                    const safeInputs = {
                        muurOppervlakte: parseFloat(inputs.muurOppervlakte) || 0,
                        raamOppervlakte: parseFloat(inputs.raamOppervlakte) || 0,
                        dakOppervlakte: parseFloat(inputs.dakOppervlakte) || 0,
                        vloerOppervlakte: parseFloat(inputs.vloerOppervlakte) || 0,
                        muurUwaarde: parseFloat(inputs.muurUwaarde) || 0,
                        raamUwaarde: parseFloat(inputs.raamUwaarde) || 0,
                        dakUwaarde: parseFloat(inputs.dakUwaarde) || 0,
                        vloerUwaarde: parseFloat(inputs.vloerUwaarde) || 0,
                        // Gebruik een standaard binnentemperatuur om te voorkomen dat tempDiff 0 wordt.
                        binnenTemp: parseFloat(inputs.binnenTemp) || 20,
                        zonnepanelenAantal: parseInt(inputs.zonnepanelenAantal, 10) || 0
                    };
                    // --- EINDE VAN DE FIX ---

                    const buitenTemp = getBuitenTemperatuur();
                    const tempDiff = Math.abs(safeInputs.binnenTemp - buitenTemp);
                    const klimaatInfo = klimaatzones[inputs.klimaatzone] || klimaatzones['H2a'];
                    
                    if (tempDiff === 0) {
                        setIsCalculating(false);
                        return;
                    }
                    
                    const muurVerlies = safeInputs.muurOppervlakte * safeInputs.muurUwaarde * tempDiff;
                    const raamVerlies = safeInputs.raamOppervlakte * safeInputs.raamUwaarde * tempDiff;
                    const dakVerlies = safeInputs.dakOppervlakte * safeInputs.dakUwaarde * tempDiff;
                    const vloerVerlies = safeInputs.vloerOppervlakte * safeInputs.vloerUwaarde * tempDiff;
                    
                    const bruttoVerlies = muurVerlies + raamVerlies + dakVerlies + vloerVerlies;
                    
                    let gedragsFactor = 1.0;
                    if (inputs.verwarmdeRuimtes === 'leefruimtes') gedragsFactor *= 0.7;
                    if (inputs.verwarmdeRuimtes === 'minimaal') gedragsFactor *= 0.5;
                    if (inputs.ventilatieGedrag === 'veel_ventileren') gedragsFactor *= 1.2;
                    if (inputs.ventilatieGedrag === 'ramen_open') gedragsFactor *= 1.5;
                    
                    const totaalVerlies = bruttoVerlies * klimaatInfo.factor * gedragsFactor;
                    const gebruiksFactor = woningGebruikOpties[inputs.woningGebruik]?.factor || 1.0;
                    const verwarmingsDagen = klimaatInfo.verwarmingsDagen * gebruiksFactor;
                    const jaarlijkseKwh = Math.max(0, (totaalVerlies / 1000) * 12 * verwarmingsDagen);
                    
                    let hoofdverwarmingPercentage = 1.0;
                    if (inputs.bijverwarmingType !== 'geen') {
                        if (inputs.bijverwarmingIntensiteit === 'hoofdverwarming') {
                            hoofdverwarmingPercentage = 0.2;
                        } else if (inputs.bijverwarmingIntensiteit === 'regelmatig') {
                            hoofdverwarmingPercentage = 0.7;
                        } else {
                            hoofdverwarmingPercentage = 0.9;
                        }
                    }
                    
                    const hoofdverwarmingKwh = jaarlijkseKwh * hoofdverwarmingPercentage;
                    const bijverwarmingKwh = jaarlijkseKwh * (1 - hoofdverwarmingPercentage);
                    
                    const zonOpbrengstPerPaneel = klimaatInfo.zonOpbrengst || 1200;
                    const orientatieFactor = zonOrientatieFactoren[inputs.zonnepanelenOrientatie] || 1.0;
                    const hellingFactor = zonHellingFactoren[inputs.zonnepanelenHelling] || 1.0;
                    const totaalZonOpbrengst = Math.max(0, safeInputs.zonnepanelenAantal * zonOpbrengstPerPaneel * orientatieFactor * hellingFactor);
                    const eigenVerbruikPercentage = 0.7;
                    const zonBesparingKwh = totaalZonOpbrengst * eigenVerbruikPercentage;
                    
                    let hoofdverwarmingKosten = 0;
                    if (inputs.hoofdverwarmingType === 'gas') {
                        hoofdverwarmingKosten = hoofdverwarmingKwh * energyPrices.gas;
                    } else if (inputs.hoofdverwarmingType === 'elektriciteit') {
                        const nettoElektriciteitsKwh = Math.max(0, hoofdverwarmingKwh - zonBesparingKwh);
                        hoofdverwarmingKosten = nettoElektriciteitsKwh * energyPrices.electricity;
                    } else if (inputs.hoofdverwarmingType === 'fioul') {
                        hoofdverwarmingKosten = hoofdverwarmingKwh * energyPrices.fioul * 0.1;
                    }
                    
                    let bijverwarmingKosten = 0;
                    if (inputs.bijverwarmingType === 'elektrisch') {
                        const nettoBijverwarmingKwh = Math.max(0, bijverwarmingKwh - Math.max(0, zonBesparingKwh - hoofdverwarmingKwh));
                        bijverwarmingKosten = nettoBijverwarmingKwh * energyPrices.electricity;
                    } else if (inputs.bijverwarmingType === 'pellets') {
                        bijverwarmingKosten = bijverwarmingKwh * energyPrices.pellets * 0.2;
                    } else if (inputs.bijverwarmingType === 'hout') {
                        bijverwarmingKosten = bijverwarmingKwh * 0.05;
                    }
                    
                    const totaleJaarKosten = hoofdverwarmingKosten + bijverwarmingKosten;
                    const jaarlijkseKostenGas = jaarlijkseKwh * energyPrices.gas;
                    const jaarlijkseKostenElektriciteit = Math.max(0, (jaarlijkseKwh - zonBesparingKwh)) * energyPrices.electricity;
                    const jaarlijkseKostenFioul = jaarlijkseKwh * energyPrices.fioul * 0.1;
                    const zonBesparing = zonBesparingKwh * energyPrices.electricity;
                    
                    setResults({
                        muurVerlies: Math.max(0, muurVerlies),
                        raamVerlies: Math.max(0, raamVerlies),
                        dakVerlies: Math.max(0, dakVerlies),
                        vloerVerlies: Math.max(0, vloerVerlies),
                        totaalVerlies: Math.max(0, totaalVerlies),
                        totaalKw: Math.max(0, totaalVerlies / 1000),
                        jaarlijkseKwh: Math.max(0, jaarlijkseKwh),
                        hoofdverwarmingKwh: Math.max(0, hoofdverwarmingKwh),
                        bijverwarmingKwh: Math.max(0, bijverwarmingKwh),
                        totaleJaarKosten: Math.max(0, totaleJaarKosten),
                        jaarlijkseKostenGas: Math.max(0, jaarlijkseKostenGas),
                        jaarlijkseKostenElektriciteit: Math.max(0, jaarlijkseKostenElektriciteit),
                        jaarlijkseKostenFioul: Math.max(0, jaarlijkseKostenFioul),
                        besparing: jaarlijkseKostenElektriciteit - jaarlijkseKostenGas,
                        verwarmingsDagen: Math.round(verwarmingsDagen),
                        totaalZonOpbrengst: Math.max(0, totaalZonOpbrengst),
                        zonBesparing: Math.max(0, zonBesparing),
                        buitenTemperatuur: buitenTemp,
                        percentages: {
                            muur: bruttoVerlies > 0 ? Math.max(0, Math.min(100, (muurVerlies / bruttoVerlies) * 100)) : 0,
                            raam: bruttoVerlies > 0 ? Math.max(0, Math.min(100, (raamVerlies / bruttoVerlies) * 100)) : 0,
                            dak: bruttoVerlies > 0 ? Math.max(0, Math.min(100, (dakVerlies / bruttoVerlies) * 100)) : 0,
                            vloer: bruttoVerlies > 0 ? Math.max(0, Math.min(100, (vloerVerlies / bruttoVerlies) * 100)) : 0
                        }
                    });
                    
                } catch (error) {
                    console.error('Calculation error:', error);
                } finally {
                    setIsCalculating(false);
                }
            }, [inputs, energyPrices]);

            const debouncedCalculate = useCallback(
                debounce(() => {
                    calculateHeatLoss();
                }, 300),
                [calculateHeatLoss]
            );

            useEffect(() => {
                debouncedCalculate();
            }, [debouncedCalculate]);

            const updateInput = (field, value) => {
                setInputs(prev => {
                    if (field === 'binnenTemp') {
                        if (value === '') return { ...prev, [field]: '' };
                        const numValue = parseFloat(value);
                        if (isNaN(numValue) || numValue < 5 || numValue > 35) return prev;
                        return { ...prev, [field]: numValue };
                    }
                    
                    if (typeof prev[field] === 'number') {
                        if (value === '') return { ...prev, [field]: '' };
                        const numValue = parseFloat(value);
                        if (isNaN(numValue) || numValue < 0) return prev;
                        
                        if (field.includes('Oppervlakte') && numValue > 1000) return prev;
                        if (field.includes('Uwaarde') && numValue > 10) return prev;
                        if (field === 'zonnepanelenAantal' && numValue > 100) return prev;
                        
                        return { ...prev, [field]: numValue };
                    }
                    
                    return { ...prev, [field]: value };
                });
            };

            const setPreset = (type, preset) => {
                const uWaarde = uWaardePresets[type][preset];
                if (uWaarde !== undefined) {
                    updateInput(`${type}Uwaarde`, uWaarde);
                }
            };

            const HeatLossChart = () => {
                if (!results.totaalVerlies || results.totaalVerlies <= 0) {
                    return (
                        <div className="bg-white p-6 rounded-lg border shadow-sm">
                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                                <TrendingDown />
                                Warmteverlies Verdeling
                            </h3>
                            <div className="text-center text-gray-500 py-8">
                                {isCalculating ? 'Berekening loopt...' : 'Voer geldige waarden in om de grafiek te tonen'}
                            </div>
                        </div>
                    );
                }
                
                const maxHeight = 200;
                const data = [
                    { naam: 'Muren', verlies: results.muurVerlies, percentage: results.percentages.muur, kleur: '#ff6b35' },
                    { naam: 'Ramen', verlies: results.raamVerlies, percentage: results.percentages.raam, kleur: '#4ecdc4' },
                    { naam: 'Dak', verlies: results.dakVerlies, percentage: results.percentages.dak, kleur: '#45b7d1' },
                    { naam: 'Vloer', verlies: results.vloerVerlies, percentage: results.percentages.vloer, kleur: '#96ceb4' }
                ];

                const maxVerlies = Math.max(...data.map(d => d.verlies));

                return (
                    <div className="bg-white p-6 rounded-lg border shadow-sm">
                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                            <TrendingDown />
                            Warmteverlies Verdeling
                        </h3>
                        <div className="flex items-end justify-center gap-4 mb-4" style={{ height: maxHeight + 40 }}>
                            {data.map((item, index) => {
                                const height = maxVerlies > 0 ? Math.max((item.verlies / maxVerlies) * maxHeight, 20) : 20;
                                return (
                                    <div key={index} className="flex flex-col items-center">
                                        <div className="text-sm font-semibold mb-2 text-gray-700">
                                            {item.percentage.toFixed(1)}%
                                        </div>
                                        <div 
                                            className="w-16 rounded-t transition-all duration-500 flex items-end justify-center text-white text-xs font-bold"
                                            style={{ 
                                                height: `${height}px`, 
                                                backgroundColor: item.kleur,
                                                minHeight: '20px'
                                            }}
                                        >
                                            {item.verlies > 100 && `${(item.verlies/1000).toFixed(1)}kW`}
                                        </div>
                                        <div className="text-sm mt-2 text-center font-medium">{item.naam}</div>
                                        <div className="text-xs text-gray-600">{item.verlies.toFixed(0)}W</div>
                                    </div>
                                );
                            })}
                        </div>
                    </div>
                );
            };

            const HouseVisualization = () => {
                const getColor = (percentage) => {
                    if (percentage > 40) return '#ff4444';
                    if (percentage > 25) return '#ff8800';
                    if (percentage > 15) return '#ffaa00';
                    return '#44aa44';
                };

                if (!results.totaalVerlies || results.totaalVerlies <= 0) {
                    return (
                        <div className="bg-white p-6 rounded-lg border shadow-sm">
                            <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                                <Home />
                                Visueel Warmteverlies Overzicht
                            </h3>
                            <div className="text-center text-gray-500 py-8">
                                {isCalculating ? 'Berekening loopt...' : 'Voer geldige waarden in om de visualisatie te tonen'}
                            </div>
                        </div>
                    );
                }

                return (
                    <div className="bg-white p-6 rounded-lg border shadow-sm">
                        <h3 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                            <Home />
                            Visueel Warmteverlies Overzicht
                        </h3>
                        <div className="flex justify-center">
                            <svg width="300" height="250" viewBox="0 0 300 250" className="max-w-full">
                                <polygon 
                                    points="50,100 150,50 250,100 200,100 150,70 100,100" 
                                    fill={getColor(results.percentages?.dak || 0)}
                                    stroke="#333" 
                                    strokeWidth="2"
                                />
                                <text x="150" y="85" textAnchor="middle" className="text-xs font-bold" fill="white">
                                    Dak: {(results.percentages?.dak || 0).toFixed(1)}%
                                </text>
                                
                                <rect 
                                    x="100" y="100" width="100" height="100" 
                                    fill={getColor(results.percentages?.muur || 0)}
                                    stroke="#333" 
                                    strokeWidth="2"
                                />
                                <text x="150" y="155" textAnchor="middle" className="text-xs font-bold" fill="white">
                                    Muren: {(results.percentages?.muur || 0).toFixed(1)}%
                                </text>
                                
                                <rect 
                                    x="120" y="120" width="25" height="40" 
                                    fill={getColor(results.percentages?.raam || 0)}
                                    stroke="#333" 
                                    strokeWidth="2"
                                />
                                <rect 
                                    x="155" y="120" width="25" height="40" 
                                    fill={getColor(results.percentages?.raam || 0)}
                                    stroke="#333" 
                                    strokeWidth="2"
                                />
                                <text x="150" y="185" textAnchor="middle" className="text-xs font-bold">
                                    Ramen: {(results.percentages?.raam || 0).toFixed(1)}%
                                </text>
                                
                                <rect 
                                    x="100" y="200" width="100" height="20" 
                                    fill={getColor(results.percentages?.vloer || 0)}
                                    stroke="#333" 
                                    strokeWidth="2"
                                />
                                <text x="150" y="235" textAnchor="middle" className="text-xs font-bold">
                                    Vloer: {(results.percentages?.vloer || 0).toFixed(1)}%
                                </text>
                                
                                <g transform="translate(10, 10)">
                                    <rect x="0" y="0" width="15" height="10" fill="#44aa44" />
                                    <text x="20" y="9" className="text-xs">Goed (&lt;15%)</text>
                                    <rect x="0" y="15" width="15" height="10" fill="#ffaa00" />
                                    <text x="20" y="24" className="text-xs">Matig (15-25%)</text>
                                    <rect x="0" y="30" width="15" height="10" fill="#ff8800" />
                                    <text x="20" y="39" className="text-xs">Slecht (25-40%)</text>
                                    <rect x="0" y="45" width="15" height="10" fill="#ff4444" />
                                    <text x="20" y="54" className="text-xs">Zeer slecht (&gt;40%)</text>
                                </g>
                            </svg>
                        </div>
                    </div>
                );
            };

            const StickyKostenoverzicht = () => (
                <div className="sticky-costs">
                    <div className="bg-white p-4 rounded-lg border shadow-lg">
                        <h3 className="text-lg font-bold mb-3 text-brand-red flex items-center gap-2">
                            <Euro />
                            Jaarlijkse Kosten
                        </h3>
                        {isCalculating ? (
                            <div className="text-center text-gray-500 py-4">
                                Berekening loopt...
                            </div>
                        ) : (
                            <div className="space-y-2">
                                <div className="p-3 bg-purple-50 rounded-lg border border-purple-200">
                                    <div className="flex justify-between items-center">
                                        <span className="text-sm font-medium">Jouw configuratie:</span>
                                        <span className="text-xl font-bold text-purple-700">
                                            ‚Ç¨{(results.totaleJaarKosten || 0).toFixed(0)}
                                        </span>
                                    </div>
                                    <div className="text-xs text-gray-600 mt-1">
                                        {inputs.hoofdverwarmingType}
                                        {inputs.bijverwarmingType !== 'geen' && ` + ${inputs.bijverwarmingType}`}
                                        {inputs.zonnepanelenAantal > 0 && ` + ${inputs.zonnepanelenAantal} zonnepanelen`}
                                    </div>
                                </div>
                                
                                <div className="space-y-1 text-sm">
                                    <div className="flex justify-between">
                                        <span>Gas verwarming:</span>
                                        <span>‚Ç¨{(results.jaarlijkseKostenGas || 0).toFixed(0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Elektrische verwarming:</span>
                                        <span>‚Ç¨{(results.jaarlijkseKostenElektriciteit || 0).toFixed(0)}</span>
                                    </div>
                                    <div className="flex justify-between">
                                        <span>Stookolie verwarming:</span>
                                        <span>‚Ç¨{(results.jaarlijkseKostenFioul || 0).toFixed(0)}</span>
                                    </div>
                                </div>
                                
                                {inputs.zonnepanelenAantal > 0 && (
                                    <div className="p-2 bg-yellow-50 rounded text-xs">
                                        <strong>Zonbesparing:</strong> ‚Ç¨{(results.zonBesparing || 0).toFixed(0)}/jaar
                                        <br />
                                        <strong>Opbrengst:</strong> {(results.totaalZonOpbrengst || 0).toFixed(0)} kWh/jaar
                                    </div>
                                )}
                                
                                <div className="p-2 bg-blue-50 rounded text-xs">
                                    <strong>Totaal verlies:</strong> {(results.totaalKw || 0).toFixed(1)} kW<br/>
                                    <strong>Jaarverbruik:</strong> {(results.jaarlijkseKwh || 0).toFixed(0)} kWh<br/>
                                    <strong>Verwarmingsdagen:</strong> {results.verwarmingsDagen || 0} dagen
                                </div>
                            </div>
                        )}
                    </div>
                </div>
            );

            return (
                <>
                    <StickyKostenoverzicht />
                    
                    <div className="main-content max-w-6xl mx-auto p-4 bg-gray-50 min-h-screen">
                        <div className="text-center mb-8 bg-white p-6 rounded-lg shadow-sm">
                            <h1 className="text-3xl font-bold mb-2 flex items-center justify-center gap-3 text-brand-red">
                                <Calculator />
                                Warmteverlies Calculator Frankrijk
                            </h1>
                            <p className="text-gray-600 mb-2">Bereken het warmteverlies van je Franse woning en ontdek waar je energie verliest</p>
                            <div className="text-sm text-blue-600">
                                Ontwikkeld voor <a href="https://www.infofrankrijk.com" target="_blank" rel="noopener" className="underline">InfoFrankrijk.com</a> en <a href="https://www.nederlanders.fr" target="_blank" rel="noopener" className="underline">Nederlanders.fr</a> door Communities Abroad ¬©
                            </div>
                            
                            <div className="mt-4 p-3 bg-gray-50 rounded-lg text-xs text-gray-600">
                                <strong>üìä Databronnen:</strong> Franse klimaatzones (RT2012), energieprijzen via <a href="https://www.cre.fr" target="_blank" rel="noopener" className="text-blue-600 underline">CRE - Commission de r√©gulation de l'√©nergie</a>, isolatiewaarden volgens Franse bouwstandaarden (RT2020)<br/>
                                <strong>üîÑ Update frequentie:</strong> Energieprijzen worden wekelijks bijgewerkt | Klimaatgegevens jaarlijks gevalideerd<br/>
                                <strong>‚ö†Ô∏è Disclaimer:</strong> Berekeningen zijn gebaseerd op offici√´le Franse normen en gemiddelde waarden. Voor specifiek advies raadpleeg een gecertificeerde energieadviseur.
                            </div>
                        </div>

                        <div className="grid lg:grid-cols-2 gap-6">
                            <div className="space-y-6">
                                {/* Klimaatzone */}
                                <div className="bg-white p-6 rounded-lg border shadow-sm">
                                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                                        <MapPin />
                                        Locatie & Klimaat
                                    </h2>
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Klimaatzone Frankrijk</label>
                                            <select 
                                                value={inputs.klimaatzone}
                                                onChange={(e) => updateInput('klimaatzone', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                            >
                                                {Object.entries(klimaatzones).map(([code, info]) => (
                                                    <option key={code} value={code}>{info.naam}</option>
                                                ))}
                                            </select>
                                            <div className="text-xs text-gray-500 mt-1">
                                                Automatisch: {results.buitenTemperatuur || getBuitenTemperatuur()}¬∞C buitentemperatuur winter
                                            </div>
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Gewenste binnen temperatuur (¬∞C)</label>
                                            <input 
                                                type="number"
                                                value={inputs.binnenTemp || ''}
                                                onChange={(e) => updateInput('binnenTemp', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="10"
                                                max="30"
                                                step="0.5"
                                                placeholder="20"
                                            />
                                        </div>
                                    </div>
                                </div>

                                {/* Oppervlaktes */}
                                <div className="bg-white p-6 rounded-lg border shadow-sm">
                                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                                        <Home />
                                        Oppervlaktes (m¬≤)
                                    </h2>
                                    <div className="grid grid-cols-2 gap-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Buitenmuren</label>
                                            <input 
                                                type="number"
                                                value={inputs.muurOppervlakte || ''}
                                                onChange={(e) => updateInput('muurOppervlakte', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="1"
                                                max="1000"
                                                placeholder="100"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Ramen & Deuren</label>
                                            <input 
                                                type="number"
                                                value={inputs.raamOppervlakte || ''}
                                                onChange={(e) => updateInput('raamOppervlakte', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="1"
                                                max="500"
                                                placeholder="20"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Dak</label>
                                            <input 
                                                type="number"
                                                value={inputs.dakOppervlakte || ''}
                                                onChange={(e) => updateInput('dakOppervlakte', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="1"
                                                max="1000"
                                                placeholder="80"
                                            />
                                        </div>
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Vloer</label>
                                            <input 
                                                type="number"
                                                value={inputs.vloerOppervlakte || ''}
                                                onChange={(e) => updateInput('vloerOppervlakte', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="1"
                                                max="1000"
                                                placeholder="80"
                                            />
                                        </div>
                                    </div>
                                </div>

                                {/* U-waarden */}
                                <div className="bg-white p-6 rounded-lg border shadow-sm">
                                    <h2 className="text-xl font-bold mb-4 flex items-center gap-2 text-brand-red">
                                        <Thermometer />
                                        Isolatiewaarden (U-waarden)
                                    </h2>
                                    <div className="mb-4 p-3 bg-blue-50 rounded-lg text-sm text-gray-700">
                                        <strong>üí° Uitleg:</strong> Een lage U-waarde betekent een hoge isolatiewaarde. Hoe lager het getal, hoe beter de isolatie en hoe minder warmteverlies.
                                    </div>
                                    
                                    <div className="space-y-4">
                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Muren - U-waarde (W/m¬≤K)</label>
                                            <div className="flex gap-2 mb-2 flex-wrap">
                                                {Object.entries(uWaardePresets.muur).map(([preset, waarde]) => (
                                                    <button
                                                        key={preset}
                                                        onClick={() => setPreset('muur', preset)}
                                                        className="px-3 py-1 text-xs bg-blue-100 text-blue-700 rounded hover:bg-blue-200 transition-colors"
                                                    >
                                                        {preset}
                                                    </button>
                                                ))}
                                            </div>
                                            <input 
                                                type="number"
                                                value={inputs.muurUwaarde || ''}
                                                onChange={(e) => updateInput('muurUwaarde', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="0.1"
                                                max="10"
                                                step="0.1"
                                                placeholder="1.8"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Ramen - U-waarde (W/m¬≤K)</label>
                                            <div className="flex gap-2 mb-2 flex-wrap">
                                                {Object.entries(uWaardePresets.raam).map(([preset, waarde]) => (
                                                    <button
                                                        key={preset}
                                                        onClick={() => setPreset('raam', preset)}
                                                        className="px-3 py-1 text-xs bg-green-100 text-green-700 rounded hover:bg-green-200 transition-colors"
                                                    >
                                                        {preset}
                                                    </button>
                                                ))}
                                            </div>
                                            <input 
                                                type="number"
                                                value={inputs.raamUwaarde || ''}
                                                onChange={(e) => updateInput('raamUwaarde', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="0.1"
                                                max="10"
                                                step="0.1"
                                                placeholder="5.0"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Dak - U-waarde (W/m¬≤K)</label>
                                            <div className="flex gap-2 mb-2 flex-wrap">
                                                {Object.entries(uWaardePresets.dak).map(([preset, waarde]) => (
                                                    <button
                                                        key={preset}
                                                        onClick={() => setPreset('dak', preset)}
                                                        className="px-3 py-1 text-xs bg-purple-100 text-purple-700 rounded hover:bg-purple-200 transition-colors"
                                                    >
                                                        {preset}
                                                    </button>
                                                ))}
                                            </div>
                                            <input 
                                                type="number"
                                                value={inputs.dakUwaarde || ''}
                                                onChange={(e) => updateInput('dakUwaarde', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="0.1"
                                                max="10"
                                                step="0.1"
                                                placeholder="2.5"
                                            />
                                        </div>

                                        <div>
                                            <label className="block text-sm font-medium mb-2 text-gray-700">Vloer - U-waarde (W/m¬≤K)</label>
                                            <div className="flex gap-2 mb-2 flex-wrap">
                                                {Object.entries(uWaardePresets.vloer).map(([preset, waarde]) => (
                                                    <button
                                                        key={preset}
                                                        onClick={() => setPreset('vloer', preset)}
                                                        className="px-3 py-1 text-xs bg-yellow-100 text-yellow-700 rounded hover:bg-yellow-200 transition-colors"
                                                    >
                                                        {preset}
                                                    </button>
                                                ))}
                                            </div>
                                            <input 
                                                type="number"
                                                value={inputs.vloerUwaarde || ''}
                                                onChange={(e) => updateInput('vloerUwaarde', e.target.value)}
                                                className="w-full p-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-red-800 focus:border-transparent"
                                                min="0.1"
                                                max="10"
                                                step="0.1"
                                                placeholder="0.8"
                                            />
                                        </div>
                                    </div>
                                </div>
                            </div>

                            <div className="space-y-6">
                                <HeatLossChart />
                                <HouseVisualization />
                                
                                <div className="bg-gray-50 p-4 rounded-lg text-xs text-gray-600">
                                    <strong>‚ö†Ô∏è Disclaimer:</strong> Deze calculator geeft indicatieve schattingen. Werkelijke verbruiken kunnen vari√´ren door specifieke omstandigheden, bouwjaar, onderhoudsstaat en gebruikspatronen. Voor officieel energieadvies raadpleeg een gecertificeerde DPE-expert.
                                </div>
                            </div>
                        </div>
                    </div>
                </>
            );
        };

        ReactDOM.render(<WarmteverliesCalculator />, document.getElementById('root'));
    </script>
</body>
</html>